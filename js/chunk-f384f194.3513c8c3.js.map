{"version":3,"sources":["webpack:///./src/views/PictureToGrayscale.vue?8bdc","webpack:///src/views/PictureToGrayscale.vue","webpack:///./src/views/PictureToGrayscale.vue?dc0e","webpack:///./src/views/PictureToGrayscale.vue","webpack:///./src/views/PictureToGrayscale.vue?47d7"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","attrs","on","fileHandler","staticClass","_v","_s","msg","previewImg","staticStyle","downloadHandler","_e","staticRenderFns","1","2","3","4","name","data","downloadURL","methods","reader","onload","onerror","readAsDataURL","input","files","setCanvas","canvas","width","height","ctx","drawImage","converToGray","imageData","i","gray","putImageData","toDataURL","aTag","setAttribute","image","src","component"],"mappings":"gJAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACE,IAAI,OAAOC,MAAM,CAAC,KAAO,QAAQC,GAAG,CAAC,OAASR,EAAIS,eAAgBT,EAAO,IAAE,CAACI,EAAG,IAAI,CAACM,YAAY,SAAS,CAACV,EAAIW,GAAGX,EAAIY,GAAGZ,EAAIa,SAAS,CAACT,EAAG,IAAI,CAACJ,EAAIW,GAAG,QAAQP,EAAG,MAAM,CAACE,IAAI,aAAaC,MAAM,CAAC,IAAMP,EAAIc,cAAcV,EAAG,MAAM,CAACW,YAAY,CAAC,OAAS,UAAU,CAACf,EAAIW,GAAG,SAAUX,EAAe,YAAEI,EAAG,SAAS,CAACI,GAAG,CAAC,MAAQR,EAAIgB,kBAAkB,CAAChB,EAAIW,GAAG,WAAWX,EAAIiB,OAAOb,EAAG,SAAS,CAACE,IAAI,aAAa,IACjgBY,EAAkB,GCkBtB,GACEC,EAAF,QACEC,EAAF,OACEC,EAAF,QACEC,EAAF,QAEA,GACEC,KAAM,qBACNC,KAFF,WAGI,MAAO,CACLV,WAAY,KACZD,IAAK,KACLY,YAAa,OAGjBC,QAAF,CACIjB,YADJ,SACA,cACA,WACM,GAAN,SACQ,IAAR,8BAEU,YADAR,KAAKY,IAAM,UAIbZ,KAAKY,IAAM,KACX,IAAR,iBAEQc,EAAOC,OAAS,SAAxB,GACU,EAAV,2BACU,EAAV,aAGQD,EAAOE,QAAU,WACf,EAAV,8CAGQF,EAAOG,cAAcC,EAAMC,MAAM,MAGrCC,UAxBJ,WAwBA,WACA,wBACA,oBACA,eACQnB,EAAWc,OAAS,WAClB,IAAV,qBACUM,EAAOC,MAAQrB,EAAWqB,MAC1BD,EAAOE,OAAStB,EAAWsB,OAC3BC,EAAIC,UAAUxB,EAAxB,KACU,EAAV,mBAIIyB,aArCJ,SAqCA,GAIM,IAHA,IAAN,oBACA,uCAEA,0BACQ,IAAR,YACA,cACA,cAEA,sBACQC,EAAUhB,KAAKiB,GAAKC,EACpBF,EAAUhB,KAAKiB,EAAI,GAAKC,EACxBF,EAAUhB,KAAKiB,EAAI,GAAKC,EAE1BL,EAAIM,aAAaH,EAAW,EAAG,GAC/B,IAAN,wBACA,0DACMvC,KAAKwB,YAAcS,EAAOU,UAAU,SAA1C,cAEI5B,gBAxDJ,WAwDA,WACA,8BACM6B,EAAKC,aAAa,WAAxB,OACM,IAAN,YACMC,EAAMC,IAAM/C,KAAKwB,YACjBsB,EAAMD,aAAa,cAAe,aAClCC,EAAMnB,OAAS,WACb,EAAR,mBACQ,EAAR,YClG4V,I,wBCQxVqB,EAAY,eACd,EACAlD,EACAmB,GACA,EACA,KACA,WACA,MAIa,aAAA+B,E,2CCnBf","file":"js/chunk-f384f194.3513c8c3.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('input',{ref:\"file\",attrs:{\"type\":\"file\"},on:{\"change\":_vm.fileHandler}}),(_vm.msg)?[_c('p',{staticClass:\"error\"},[_vm._v(_vm._s(_vm.msg))])]:[_c('p',[_vm._v(\"預覽\")]),_c('img',{ref:\"previewImg\",attrs:{\"src\":_vm.previewImg}}),_c('div',{staticStyle:{\"margin\":\"5px 0\"}},[_vm._v(\" 灰度圖 \"),(_vm.downloadURL)?_c('button',{on:{\"click\":_vm.downloadHandler}},[_vm._v(\"下載灰度圖\")]):_vm._e()]),_c('canvas',{ref:\"canvas\"})]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <input type=\"file\" ref=\"file\" @change=\"fileHandler\"/>\n    <template v-if=\"msg\">\n      <p class=\"error\">{{msg}}</p>\n    </template>\n    <template v-else>\n      <p>預覽</p>\n      <img :src=\"previewImg\" ref=\"previewImg\">\n      <div style=\"margin:5px 0;\">\n        灰度圖\n        <button @click=\"downloadHandler\" v-if=\"downloadURL\">下載灰度圖</button>\n      </div>\n      <canvas ref=\"canvas\"></canvas>\n    </template>\n  </div>\n</template>\n\n<script>\nconst FILEERROR = {\n  1 : '未找到文件',\n  2 : '安全錯誤', \n  3 : '讀取被中斷',\n  4 : '編碼錯誤'\n} \nexport default {\n  name: 'PictureToGrayscale',\n  data(){\n    return {\n      previewImg: null,\n      msg: null,\n      downloadURL: null\n    }\n  },\n  methods:{\n    fileHandler(evnet){\n      let input = evnet.target\n      if(input.files){\n        if(!/image/.test(input.files[0].type)){\n          this.msg = '僅能上傳圖片'\n          return \n        }\n\n        this.msg = null\n        let reader = new FileReader();\n        \n        reader.onload = (e) =>{\n          this.previewImg = e.target.result\n          this.setCanvas()\n        }\n        \n        reader.onerror = () =>{\n          this.msg = `無法讀取檔案, 錯誤原因: ${FILEERROR[reader.error.code]}`\n        }\n\n        reader.readAsDataURL(input.files[0])\n      }\n    },\n    setCanvas(){\n      let previewImg = this.$refs.previewImg\n      let canvas = this.$refs.canvas\n      if(canvas.getContext){\n        previewImg.onload = () => {\n          let ctx = canvas.getContext(\"2d\")\n          canvas.width = previewImg.width\n          canvas.height = previewImg.height\n          ctx.drawImage(previewImg,0,0)\n          this.converToGray(ctx)\n        }\n      }\n    },\n    converToGray(ctx){\n      let canvas = this.$refs.canvas\n      let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n      // 每個像素都包含紅、綠、藍、透明度, 所以 i 必須加四才能取得下一個像素\n      for (let i = 0; i < imageData.data.length; i += 4) {\n        let red = imageData.data[i];\n        let green = imageData.data[i + 1];\n        let blue = imageData.data[i + 2];\n        // 取得平均值\n        let gray = parseInt((red + green + blue) / 3);\n        imageData.data[i] = gray;\n        imageData.data[i + 1] = gray;\n        imageData.data[i + 2] = gray;\n      }\n      ctx.putImageData(imageData, 0, 0);\n      let previewImg = this.$refs.previewImg\n      const extension = previewImg.src.substring(previewImg.src.lastIndexOf('.') + 1).toLowerCase();\n      this.downloadURL = canvas.toDataURL(`image/${extension}`,1)\n    },\n    downloadHandler(){\n      const aTag = document.createElement('a')\n      aTag.setAttribute('download','灰度圖')\n      const image = new Image();\n      image.src = this.downloadURL\n      image.setAttribute('crossOrigin', 'Anonymous');\n      image.onload = () => {\n          aTag.href = this.downloadURL\n          aTag.click();\n      };\n      }\n  }\n}\n</script>\n\n<style scoped>\n.error{\n  color: red\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PictureToGrayscale.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PictureToGrayscale.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PictureToGrayscale.vue?vue&type=template&id=2440952f&scoped=true&\"\nimport script from \"./PictureToGrayscale.vue?vue&type=script&lang=js&\"\nexport * from \"./PictureToGrayscale.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PictureToGrayscale.vue?vue&type=style&index=0&id=2440952f&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2440952f\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PictureToGrayscale.vue?vue&type=style&index=0&id=2440952f&scoped=true&lang=css&\""],"sourceRoot":""}